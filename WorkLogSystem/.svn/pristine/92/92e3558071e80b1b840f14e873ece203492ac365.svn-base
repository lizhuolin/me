<%@ page language="java" contentType="text/html; charset=utf-8"
    pageEncoding="utf-8"%>
 <%@ taglib prefix="s" uri="/struts-tags" %>
<%
String path = request.getContextPath();
String basePath = request.getScheme()+"://"+request.getServerName()+":"+request.getServerPort()+path+"/";
%>  
<html> 
<head>
<!-- 第一步：只需要引入自己独有的js即可    js统一放到js文件夹下面，并按模块建立单独文件夹-->
<jsp:include page="/common/common.jsp"></jsp:include>
<script src="<%=basePath %>common/ajaxfileupload.js"></script>
<script src="<%=basePath %>/js/log/changeLog.js"></script>
<script type="text/javascript">
function ajaxFileUpload() {
    $.ajaxFileUpload({
            url:rooPath + '/fileoperate/fileoperate_imageUpload.action',//用于文件上传的服务器端请求地址
            secureuri:false,//一般设置为false
            fileElementId:'image',//文件上传空间的id属性  <input type="file" id="file" name="file" />
            dataType: 'json',//返回值类型 一般设置为json
            data : {"childPath" : "log"},
            success: function (data, status){  //服务器成功响应处理函数
             if (typeof(data.error) != 'undefined') {
                     if (data.error != '') {
                    	 opFail(data.error);
                     } else {
                $("#headImg").val(data.imagePath);
            	$("#showImg").append("<img  src='"+rooPath + '/' + data.imagePath + "'/>");
             	opSuccess(data.message);
                     }
                 }
             	
            },
            error: function (data, status, e){//服务器响应失败处理函数
            	opFail(data.message);
            }
        });
    return false;
}
</script>
</head>
<body>
  <form id="editForm">
  <div class="edit">
    <ul>
   
        <li>
      	<s:iterator var="logdetail" value="logDetailList" status="s">
             	<!--<s:iterator value="logdetail">-->
             	
             	  <s:if test="null != tblProject">
				 <div class="log_send">
				 
               		<p><span>项目<samp>:</samp>
					<s:property value="tblProject.projectName"/>
					<input type="hidden" name="logDetailList[<s:property value="#s.index"/>].logDetailId" value="${logdetail.logDetailId }"/>
             		<input type="hidden" name="logDetailList[<s:property value="#s.index"/>].tblLog.logId" value="${logdetail.tblLog.logId }"/>
					<input type="hidden" name="logDetailList[<s:property value="#s.index"/>].tblProject.projectId" value="${logdetail.tblProject.projectId }"/>
					</span>
            		<span class="toRight">工时<samp>:</samp><select name="logDetailList[<s:property value="#s.index"/>].logTime" >
                              <option value="0" <s:if test="logTime==0">selected="selected"</s:if>>0工时</option>
        					<option value="1"<s:if test="logTime==1">selected="selected"</s:if>>1工时</option>
        					<option value="2"<s:if test="logTime==2">selected="selected"</s:if>>2工时</option>
        					<option value="3"<s:if test="logTime==3">selected="selected"</s:if>>3工时</option>
        					<option value="4"<s:if test="logTime==4">selected="selected"</s:if>>4工时</option>
        					<option value="5"<s:if test="logTime==5">selected="selected"</s:if>>5工时</option>
        					<option value="6"<s:if test="logTime==6">selected="selected"</s:if>>6工时</option>
        					<option value="7"<s:if test="logTime==7">selected="selected"</s:if>>7工时</option>
        					<option value="8"<s:if test="logTime==8">selected="selected"</s:if>>8工时</option>
        					<option value="9"<s:if test="logTime==9">selected="selected"</s:if>>9工时</option>
        					<option value="10"<s:if test="logTime==10">selected="selected"</s:if>>10工时</option>
                             </select>
                   </span></p>
                  
                 </div>
                  </s:if>
                  <s:elseif test="null != tblTask">
                 <div class="log_send">
                  
                 <p><span>任务<samp>:</samp>
                 <input type="hidden" name="logDetailList[<s:property value="#s.index"/>].logDetailId" value="${logdetail.logDetailId }"/>
             	<input type="hidden" name="logDetailList[<s:property value="#s.index"/>].tblTask.taskId" value="${logdetail.tblTask.taskId }"/>
             	<input type="hidden" name="logDetailList[<s:property value="#s.index"/>].tblLog.logId" value="${logdetail.tblLog.logId }"/>
             	
				<s:property value="tblTask.taskMsg"/>
				</span>
				<span  class="toRight">工时<samp>:</samp>
					 <select name="logDetailList[<s:property value="#s.index"/>].logTime" >
        				<option value="0" <s:if test="logTime==0">selected="selected"</s:if>>0工时</option>
        				<option value="1"<s:if test="logTime==1">selected="selected"</s:if>>1工时</option>
        				<option value="2"<s:if test="logTime==2">selected="selected"</s:if>>2工时</option>
        				<option value="3"<s:if test="logTime==3">selected="selected"</s:if>>3工时</option>
        				<option value="4"<s:if test="logTime==4">selected="selected"</s:if>>4工时</option>
        				<option value="5"<s:if test="logTime==5">selected="selected"</s:if>>5工时</option>
        				<option value="6"<s:if test="logTime==6">selected="selected"</s:if>>6工时</option>
        				<option value="7"<s:if test="logTime==7">selected="selected"</s:if>>7工时</option>
        				<option value="8"<s:if test="logTime==8">selected="selected"</s:if>>8工时</option>
        				<option value="9"<s:if test="logTime==9">selected="selected"</s:if>>9工时</option>
        				<option value="10"<s:if test="logTime==10">selected="selected"</s:if>>10工时</option>
        			</select>
				</span></p>
				
                 </div>
                 </s:elseif>
                 <s:else></s:else>
                <!--</s:iterator>-->
				</s:iterator>
				</li>
				 <s:hidden name="tblLog.logId"/>
    			<s:hidden name="tblLog.logTime"/>
    			<s:hidden name="tblLog.createTime"/>
    			<s:hidden name="tblLog.tblUser.userId"/>
    			<s:hidden name="tblLog.tblCompany.companyId"/>
    			<s:hidden name="tblLog.dataStatus"/>
    			<s:hidden name="tblLog.comTime"/>
      			<li>
        		<span><i>日志时间</i><samp>:</samp>
        		<input type="text" name="tblLog.logTime" value="${tblLog.logTime }" readonly="readonly"/><samp></samp>
          		<div class="d_list"></div>
        		</span>
       			</li>
       			<li >
      			<span><i>图像</i><samp>:</samp>
	            <a class="upload_btn">选择文件</a>
		        <input type="file" name="image" id="image" onchange="ajaxFileUpload()"/>
	            <img src="<%=basePath %>images/loading.gif" id="loading" style="display: none;">
	           <input type="hidden" id="headImg" name="tblLog.logPicture"  value="<s:property value='tblLog.logPicture'/>"/>    
	    </span>  </li>
	    <li id="showImg"></li>
		<li >
        <span><i>日志内容</i><samp>:</samp>
        	<p><textarea id="logMsg"  type="text" name="tblLog.logMsg" ><s:property value="tblLog.logMsg"/></textarea></p>
        	<label class="require_lab"></label>
      </span></li>
    </ul>
  </div>
</form>

<div class="edit_btn"><a id="edit" >保存</a><a id="close" class="btn_cancel" >取消</a></div>
  
 <!-- 保存遮罩层-->
  <!--<div class="edit_cover"><p><img src="images/loading.gif"></p></div>-->

</body>
</html>
